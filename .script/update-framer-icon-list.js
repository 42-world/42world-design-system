const fs = require('fs');
const path = require('path');

function getIconFilesName(iconPath) {
  const iconFiles = fs.readdirSync(path.join(__dirname, '..', iconPath));

  return iconFiles.map((iconFile) => iconFile.replace('.svg', ''));
}

function getIconList(iconPath) {
  const filled = getIconFilesName(`${iconPath}/filled`);
  const outlined = getIconFilesName(`${iconPath}/outlined`);
  const round = getIconFilesName(`${iconPath}/round`);
  const sharp = getIconFilesName(`${iconPath}/sharp`);
  const towTone = getIconFilesName(`${iconPath}/two-tone`);

  const isIconExixtInAllTypes = (icon) =>
    outlined.includes(icon) && //
    round.includes(icon) &&
    sharp.includes(icon) &&
    towTone.includes(icon);
  const allIcons = [...new Set([...filled, ...outlined, ...round, ...sharp, ...towTone])];

  return allIcons.filter(isIconExixtInAllTypes);
}

function writeIconListCode(codePath, iconList) {
  const code = `// This file is auto generated by .script/update-framer-icon-list.js
// Please don't edit it manually.

export const ICONS = [\n${iconList.map((icon) => `  '${icon}',`).join('\n')}\n] as const;
`;

  fs.writeFileSync(path.join(__dirname, '..', codePath), code);
}

const iconList = getIconList('node_modules/@material-design-icons/svg');
writeIconListCode('src/common/framer/icon/icons.ts', iconList);
